version: '3.8'
services:
  backend-5001:
    image: node:18-alpine
    container_name: rsv-backend-5001
    ports:
      - "5001:5001"
    environment:
      - NODE_ENV=development
      - PORT=5001
    command: >
      sh -c "
        apk add --no-cache curl &&
        mkdir -p /app && cd /app &&
        echo 'const express = require(\"express\");
        const app = express();
        const port = 5001;
        app.use(express.json());
        app.get(\"/health\", (req, res) => {
          res.json({status: \"healthy\", service: \"Backend 5001\", timestamp: new Date().toISOString()});
        });
        app.listen(port, () => console.log(\"Backend 5001 running\"));
        ' > server.js &&
        npm init -y && npm install express && node server.js
      "
    restart: unless-stopped

  backend-5002:
    image: node:18-alpine
    container_name: rsv-backend-5002
    ports:
      - "5002:5002"
    environment:
      - NODE_ENV=development
      - PORT=5002
    command: >
      sh -c "
        apk add --no-cache curl &&
        mkdir -p /app && cd /app &&
        echo 'const express = require(\"express\");
        const app = express();
        const port = 5002;
        app.use(express.json());
        app.get(\"/health\", (req, res) => {
          res.json({status: \"healthy\", service: \"Backend 5002\", timestamp: new Date().toISOString()});
        });
        app.listen(port, () => console.log(\"Backend 5002 running\"));
        ' > server.js &&
        npm init -y && npm install express && node server.js
      "
    restart: unless-stopped

  backend-5003:
    image: node:18-alpine
    container_name: rsv-backend-5003
    ports:
      - "5003:5003"
    environment:
      - NODE_ENV=development
      - PORT=5003
    command: >
      sh -c "
        apk add --no-cache curl &&
        mkdir -p /app && cd /app &&
        echo 'const express = require(\"express\");
        const app = express();
        const port = 5003;
        app.use(express.json());
        app.get(\"/health\", (req, res) => {
          res.json({status: \"healthy\", service: \"Backend 5003\", timestamp: new Date().toISOString()});
        });
        app.listen(port, () => console.log(\"Backend 5003 running\"));
        ' > server.js &&
        npm init -y && npm install express && node server.js
      "
    restart: unless-stopped
